function TE_conoid = TE_conoid_eul(t,q,model)
conoid_length = model.conoid_length;
conoid_stiffness = model.conoid_stiffness;
conoid_eps = model.conoid_eps;
conoid_origin1 = model.conoid_origin(:,1);
conoid_origin2 = model.conoid_origin(:,2);
conoid_origin3 = model.conoid_origin(:,3);
conoid_insertion1 = model.conoid_insertion(:,1);
conoid_insertion2 = model.conoid_insertion(:,2);
conoid_insertion3 = model.conoid_insertion(:,3);
qsubs1 = q(1,:);
qsubs2 = q(2,:);
qsubs3 = q(3,:);
qsubs4 = q(4,:);
qsubs5 = q(5,:);
qsubs6 = q(6,:);
qsubs7 = q(7,:);
qsubs8 = q(8,:);
qsubs9 = q(9,:);
qsubs10 = q(10,:);
x0 = sin(qsubs4);
x1 = cos(qsubs5);
x2 = sin(qsubs6);
x3 = cos(qsubs4);
x4 = x2.*x3;
x5 = sin(qsubs5);
x6 = cos(qsubs6);
x7 = x0.*x6;
x8 = x4 + x5.*x7;
x9 = conoid_insertion2.*x8;
x10 = x0.*x2;
x11 = -x10.*x5 + x3.*x6;
x12 = conoid_insertion3.*x11;
x13 = conoid_insertion1.*x1;
x14 = x4.*x5 + x7;
x15 = x3.*x6;
x16 = x10 - x15.*x5;
x17 = -conoid_insertion2.*x16 - conoid_insertion3.*x14 + conoid_origin1 - x13.*x3 - 0.1575;
x18 = x17/2;
x19 = -x16;
x20 = 2*conoid_insertion2;
x21 = 2*conoid_insertion3;
x22 = conoid_origin3 + x0.*x13 - x12 - x9;
x23 = x22/2;
x24 = conoid_insertion1.*x5;
x25 = -conoid_insertion2.*x1.*x6 + conoid_insertion3.*x1.*x2 + conoid_origin2 - x24;
x26 = sqrt(x17.^2 + x22.^2 + x25.^2);
x27 = conoid_stiffness.*(-conoid_length + x26 + sqrt(conoid_eps + (-conoid_length + x26).^2))./(2*x26);
x28 = x25/2;
x29 = 2*x24;
x30 = x1.*x20;
x31 = x1.*x21;
TE_conoid = [0 0 0 -x27.*(x18.*(2*conoid_insertion1.*x0.*x1 - 2*x12 - 2*x9) + x23.*(2*conoid_insertion1.*x1.*x3 + x14.*x21 - x19.*x20)) -x27.*(x18.*(x15.*x30 + x29.*x3 - x31.*x4) + x23.*(2*conoid_insertion3.*x0.*x1.*x2 - x0.*x29 - x30.*x7) + x28.*(2*conoid_insertion2.*x5.*x6 - 2*conoid_insertion3.*x2.*x5 - 2*x13)) -x27.*(x18.*(-x14.*x20 - x19.*x21) + x23.*(-x11.*x20 + x21.*x8) + x28.*(x2.*x30 + x31.*x6)) 0 0 0 0];
